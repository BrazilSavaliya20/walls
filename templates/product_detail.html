<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ product.name }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-gold: #D4AF37;
      --dark-gold: #B8941F;
      --light-gold: #F5E6A3;
      --accent-gold: #FFD700;
      --text-dark: #1a1a1a;
      --text-medium: #4a4a4a;
      --text-light: #6b6b6b;
      --bg-primary: #fafafa;
      --bg-secondary: #ffffff;
      --border-light: #e8e8e8;
      --shadow-light: rgba(212, 175, 55, 0.1);
      --shadow-medium: rgba(212, 175, 55, 0.15);
      --shadow-heavy: rgba(0, 0, 0, 0.1);
      --border-radius: 12px;
      --border-radius-lg: 20px;
    }

    body {
      background: linear-gradient(135deg, var(--bg-primary) 0%, #f0f0f0 100%);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: var(--text-dark);
      line-height: 1.6;
      overflow-x: hidden;
      min-height: 100vh;
    }

    .main-container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 24px 16px;
    }

    .product-container {
      background: var(--bg-secondary);
      border-radius: var(--border-radius-lg);
      box-shadow: 
        0 20px 60px var(--shadow-light),
        0 8px 25px var(--shadow-heavy);
      overflow: hidden;
      position: relative;
    }

    .product-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-gold), var(--accent-gold), var(--primary-gold));
      z-index: 1;
    }

    .product-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      min-height: 500px;
    }

    /* Gallery Section */
    .gallery-section {
      padding: 32px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.02), transparent);
    }

    .main-image-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 1;
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: 0 12px 30px var(--shadow-medium);
      background: linear-gradient(45deg, #f8f8f8, #ffffff);
    }

    .main-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: zoom-in;
    }

    .main-image:hover {
      transform: scale(1.03);
    }

    .image-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        135deg,
        rgba(212, 175, 55, 0.03) 0%,
        transparent 50%,
        rgba(255, 215, 0, 0.03) 100%
      );
      pointer-events: none;
    }

    .thumbnail-container {
      width: 100%;
    }

    .thumbnail-list {
      display: flex;
      gap: 8px;
      padding: 4px;
      overflow-x: auto;
      scroll-behavior: smooth;
      scrollbar-width: thin;
      scrollbar-color: var(--primary-gold) transparent;
    }

    .thumbnail-list::-webkit-scrollbar {
      height: 6px;
    }

    .thumbnail-list::-webkit-scrollbar-track {
      background: rgba(212, 175, 55, 0.1);
      border-radius: 10px;
    }

    .thumbnail-list::-webkit-scrollbar-thumb {
      background: var(--primary-gold);
      border-radius: 10px;
    }

    .thumbnail {
      width: 70px;
      height: 70px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
      border: 3px solid transparent;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      flex-shrink: 0;
    }

    .thumbnail:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px var(--shadow-medium);
      border-color: var(--light-gold);
    }

    .thumbnail.selected {
      border-color: var(--primary-gold);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px var(--shadow-medium);
    }

    /* Product Info Section */
    .info-section {
      padding: 32px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      background: var(--bg-secondary);
    }

    .product-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--primary-gold), var(--accent-gold));
      color: white;
      padding: 6px 12px;
      border-radius: 16px;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      width: fit-content;
      box-shadow: 0 4px 12px var(--shadow-light);
    }

    .product-title {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.5rem, 3.5vw, 2.5rem);
      font-weight: 700;
      color: var(--text-dark);
      line-height: 1.2;
      margin: 0;
      word-wrap: break-word;
      hyphens: auto;
    }

    .price-section {
      margin: 8px 0;
    }

    .price-display {
      font-size: clamp(1.2rem, 2.5vw, 1.8rem);
      font-weight: 700;
      color: var(--primary-gold);
      margin-bottom: 4px;
    }

    .price-note {
      font-size: 0.85rem;
      color: var(--text-light);
      font-style: italic;
    }

    /* Size Selection */
    .size-section {
      width: 100%;
    }

    .size-label {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
      display: block;
    }

    .size-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      width: 100%;
    }

    .size-btn {
      background: linear-gradient(135deg, white, #f8f8f8);
      border: 2px solid var(--border-light);
      border-radius: 10px;
      color: var(--text-medium);
      font-weight: 600;
      padding: 10px 8px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      word-break: keep-all;
    }

    .size-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px var(--shadow-light);
      border-color: var(--primary-gold);
    }

    .size-btn.active {
      background: linear-gradient(135deg, var(--primary-gold), var(--accent-gold));
      color: white;
      border-color: var(--dark-gold);
      box-shadow: 0 6px 16px var(--shadow-medium);
      transform: translateY(-1px);
    }

    /* Purchase Section */
    .purchase-section {
      width: 100%;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.03), rgba(255, 215, 0, 0.03));
      border-radius: var(--border-radius);
      padding: 20px;
      border: 1px solid rgba(212, 175, 55, 0.1);
    }

    .quantity-row {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
      width: 100%;
    }

    .quantity-wrapper {
      display: flex;
      align-items: center;
      background: white;
      border: 2px solid var(--border-light);
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      overflow: hidden;
    }

    .quantity-btn {
      border: none;
      background: transparent;
      font-size: 1.1rem;
      padding: 8px 12px;
      color: var(--primary-gold);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .quantity-btn:hover {
      background: var(--primary-gold);
      color: white;
    }

    .quantity-display {
      min-width: 40px;
      text-align: center;
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-dark);
      background: white;
      padding: 0 8px;
    }

    .cart-btn {
      background: linear-gradient(135deg, var(--primary-gold), var(--accent-gold));
      color: white;
      font-weight: 700;
      border: none;
      border-radius: 10px;
      padding: 12px 20px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      letter-spacing: 0.5px;
      text-transform: uppercase;
      box-shadow: 0 6px 16px var(--shadow-medium);
      flex: 1;
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .cart-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 20px var(--shadow-medium);
    }

    .cart-btn:active {
      transform: translateY(0);
    }

    /* Features Section - Fixed for long text */
    .features-section {
      width: 100%;
      background: rgba(248, 248, 248, 0.5);
      border-radius: var(--border-radius);
      padding: 20px;
      border: 1px solid var(--border-light);
    }

    .features-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .features-title::before {
      content: '✨';
      font-size: 1.1rem;
      flex-shrink: 0;
    }

    .features-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .features-list li {
      color: var(--text-medium);
      font-size: 0.9rem;
      position: relative;
      padding-left: 18px;
      line-height: 1.4;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
      max-width: 100%;
    }

    .features-list li::before {
      content: '•';
      color: var(--primary-gold);
      font-weight: bold;
      position: absolute;
      left: 0;
      font-size: 1.1rem;
      top: 0;
      flex-shrink: 0;
    }

    /* Description Section */
    .description-section {
      padding: 24px 32px;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.02), rgba(255, 215, 0, 0.02));
      border-top: 1px solid rgba(212, 175, 55, 0.1);
      position: relative;
    }

    .description-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 32px;
      right: 32px;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-gold), var(--accent-gold), var(--primary-gold));
    }

    .description-title {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.3rem, 2.5vw, 1.8rem);
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 16px;
      position: relative;
      padding-bottom: 8px;
    }

    .description-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-gold), var(--accent-gold));
      border-radius: 2px;
    }

    .description-content {
      color: var(--text-medium);
      font-size: 1rem;
      line-height: 1.7;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
    }

    /* Mobile Responsive - Optimized spacing */
    @media (max-width: 968px) {
      .main-container {
        padding: 16px 12px;
      }
      
      .product-grid {
        grid-template-columns: 1fr;
        min-height: auto;
      }
      
      .gallery-section {
        padding: 24px;
        border-bottom: 1px solid var(--border-light);
      }
      
      .info-section {
        padding: 24px;
      }
      
      .description-section {
        padding: 20px 24px;
      }
      
      .description-section::before {
        left: 24px;
        right: 24px;
      }
      
      .main-image-wrapper {
        aspect-ratio: 4/3;
      }
    }

    @media (max-width: 768px) {
      .main-container {
        padding: 12px 8px;
      }
      
      .product-container {
        border-radius: 16px;
      }
      
      .gallery-section,
      .info-section {
        padding: 20px;
      }
      
      .description-section {
        padding: 16px 20px;
      }
      
      .description-section::before {
        left: 20px;
        right: 20px;
      }
      
      .main-image-wrapper {
        aspect-ratio: 1;
      }
      
      .thumbnail {
        width: 60px;
        height: 60px;
      }
      
      .quantity-row {
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
      }
      
      .quantity-wrapper {
        align-self: center;
        width: fit-content;
      }
      
      .cart-btn {
        width: 100%;
      }
      
      .purchase-section {
        padding: 16px;
      }
      
      .features-section {
        padding: 16px;
      }
    }

    @media (max-width: 480px) {
      .main-container {
        padding: 8px;
      }
      
      .gallery-section,
      .info-section {
        padding: 16px;
      }
      
      .description-section {
        padding: 14px 16px;
      }
      
      .description-section::before {
        left: 16px;
        right: 16px;
      }
      
      .main-image-wrapper {
        aspect-ratio: 1;
      }
      
      .thumbnail {
        width: 55px;
        height: 55px;
      }
      
      .size-grid {
        grid-template-columns: 1fr;
        max-width: 280px;
        margin: 0 auto;
        gap: 8px;
      }
      
      .size-btn {
        padding: 12px 16px;
        font-size: 0.9rem;
      }
      
      .purchase-section {
        padding: 14px;
      }
      
      .features-section {
        padding: 14px;
      }
      
      .product-title {
        text-align: left;
      }
      
      .price-display {
        text-align: left;
      }
      
      .features-list li {
        font-size: 0.85rem;
        padding-left: 16px;
      }
      
      .description-content {
        font-size: 0.95rem;
      }
    }

    @media (max-width: 360px) {
      .main-container {
        padding: 6px;
      }
      
      .gallery-section,
      .info-section {
        padding: 12px;
      }
      
      .description-section {
        padding: 12px;
      }
      
      .description-section::before {
        left: 12px;
        right: 12px;
      }
      
      .thumbnail {
        width: 50px;
        height: 50px;
      }
      
      .size-btn {
        padding: 10px 12px;
        font-size: 0.85rem;
        min-height: 40px;
      }
      
      .quantity-btn {
        width: 36px;
        height: 36px;
        font-size: 1rem;
      }
      
      .quantity-display {
        min-width: 36px;
        font-size: 0.95rem;
      }
      
      .cart-btn {
        padding: 10px 16px;
        font-size: 0.9rem;
      }
      
      .purchase-section {
        padding: 12px;
      }
      
      .features-section {
        padding: 12px;
      }
    }

    /* Focus styles for accessibility */
    .size-btn:focus,
    .quantity-btn:focus,
    .cart-btn:focus,
    .thumbnail:focus {
      outline: 2px solid var(--primary-gold);
      outline-offset: 2px;
    }

    /* Smooth animations */
    .main-image,
    .thumbnail,
    .size-btn,
    .quantity-btn,
    .cart-btn {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .price-display {
      transition: all 0.2s ease;
    }

    /* Loading state */
    .loading {
      opacity: 0.7;
      transform: scale(0.98);
    }
  </style>
</head>
<body>
  <div class="main-container">
    <div class="product-container">
      <div class="product-grid">
        <!-- Gallery Section -->
        <div class="gallery-section">
          <div class="main-image-wrapper">
            <img src="{{ product.imgs[0] }}" id="mainImage" alt="{{ product.name }}" class="main-image" />
            <div class="image-overlay"></div>
          </div>
          <div class="thumbnail-container">
            <div class="thumbnail-list" id="thumbnails">
              {% for img in product.imgs %}
                <img src="{{ img }}" class="thumbnail {% if loop.index0 == 0 %}selected{% endif %}" 
                     data-idx="{{ loop.index0 }}" alt="Product image {{ loop.index }}" tabindex="0" />
              {% endfor %}
            </div>
          </div>
        </div>

        <!-- Product Info Section -->
        <div class="info-section">
          <div class="product-badge">Premium Quality</div>
          
          <h1 class="product-title">{{ product.name }}</h1>
          
          <div class="price-section">
            <div class="price-display" id="priceDisplay">
              ₹{{ product.price_small }} – ₹{{ product.price_large }}
            </div>
            <div class="price-note">Price varies by size</div>
          </div>

          <div class="size-section">
            <label class="size-label">Select Size</label>
            <div class="size-grid" id="sizeButtons" role="radiogroup" aria-label="Product size selection">
              <button type="button" class="size-btn" data-size="small" 
                      data-price="{{ product.price_small|replace('₹','')|replace(',','') }}" 
                      role="radio" aria-checked="false">Small</button>
              <button type="button" class="size-btn active" data-size="medium" 
                      data-price="{{ product.price_medium|replace('₹','')|replace(',','') }}" 
                      role="radio" aria-checked="true">Medium</button>
              <button type="button" class="size-btn" data-size="large" 
                      data-price="{{ product.price_large|replace('₹','')|replace(',','') }}" 
                      role="radio" aria-checked="false">Large</button>
            </div>
          </div>

          <div class="purchase-section">
            <form id="addToCartForm" method="POST" action="{{ url_for('add_to_cart') }}">
              <div class="quantity-row">
                <div class="quantity-wrapper">
                  <button type="button" class="quantity-btn" id="decreaseQty" aria-label="Decrease quantity">−</button>
                  <span class="quantity-display" id="qtyDisplay" role="status" aria-live="polite">1</span>
                  <button type="button" class="quantity-btn" id="increaseQty" aria-label="Increase quantity">+</button>
                </div>
                <input type="hidden" name="quantity" id="qtyInput" value="1" />
                <input type="hidden" name="product_id" value="{{ product.id }}" />
                <input type="hidden" name="size" id="selectedSize" value="medium" />
                <button type="submit" class="cart-btn" aria-label="Add item to shopping cart">
                  <span>Add to Cart</span>
                </button>
              </div>
            </form>
          </div>

          <div class="features-section">
            <div class="features-title">Key Features</div>
            <ul class="features-list">
              {% if product.features %}
                {% for feature in product.features %}
                  <li>{{ feature }}</li>
                {% endfor %}
              {% else %}
                <li>Premium quality materials</li>
                <li>Expert craftsmanship</li>
                <li>Satisfaction guaranteed</li>
                <li>Fast & secure delivery</li>
              {% endif %}
            </ul>
          </div>
        </div>
      </div>

      <!-- Description Section -->
      <div class="description-section">
        <h2 class="description-title">Product Description</h2>
        <div class="description-content">
          {{ product.desc_long if product.desc_long else product.desc if product.desc else "This premium product combines exceptional quality with elegant design. Crafted with attention to detail and built to last, it offers the perfect blend of functionality and style. Each piece is carefully inspected to ensure it meets our high standards of excellence." }}
        </div>
      </div>
    </div>
  </div>

  <script>
    // Image gallery functionality
    document.querySelectorAll('.thumbnail').forEach((thumb) => {
      thumb.addEventListener('click', function() {
        const mainImage = document.getElementById('mainImage');
        
        // Add loading effect
        mainImage.classList.add('loading');
        
        setTimeout(() => {
          mainImage.src = this.src;
          mainImage.classList.remove('loading');
        }, 150);
        
        // Update selected state
        document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('selected'));
        this.classList.add('selected');
      });

      // Keyboard support
      thumb.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          this.click();
        }
      });
    });

    // Size selection
    const sizeButtons = document.querySelectorAll('.size-btn');
    const priceDisplay = document.getElementById('priceDisplay');
    const selectedSizeInput = document.getElementById('selectedSize');

    sizeButtons.forEach(btn => {
      btn.addEventListener('click', function() {
        // Update active state
        sizeButtons.forEach(b => {
          b.classList.remove('active');
          b.setAttribute('aria-checked', 'false');
        });
        this.classList.add('active');
        this.setAttribute('aria-checked', 'true');
        selectedSizeInput.value = this.dataset.size;

        // Update price
        const priceValue = parseFloat(this.dataset.price);
        if (!isNaN(priceValue)) {
          priceDisplay.style.transform = 'scale(0.95)';
          priceDisplay.style.opacity = '0.7';
          
          setTimeout(() => {
            priceDisplay.textContent = "₹" + priceValue.toLocaleString('en-IN');
            priceDisplay.style.transform = 'scale(1)';
            priceDisplay.style.opacity = '1';
          }, 150);
        }
      });
    });

    // Quantity controls
    let quantity = 1;
    const qtyDisplay = document.getElementById('qtyDisplay');
    const qtyInput = document.getElementById('qtyInput');
    const decreaseBtn = document.getElementById('decreaseQty');
    const increaseBtn = document.getElementById('increaseQty');

    function updateQuantity(newQty) {
      quantity = Math.max(1, Math.min(99, newQty));
      qtyDisplay.textContent = quantity;
      qtyInput.value = quantity;
      
      // Update button states
      decreaseBtn.style.opacity = quantity <= 1 ? '0.5' : '1';
      decreaseBtn.disabled = quantity <= 1;
      increaseBtn.style.opacity = quantity >= 99 ? '0.5' : '1';
      increaseBtn.disabled = quantity >= 99;
      
      // Animation
      qtyDisplay.style.transform = 'scale(1.1)';
      setTimeout(() => {
        qtyDisplay.style.transform = 'scale(1)';
      }, 150);
    }

    increaseBtn.addEventListener('click', () => updateQuantity(quantity + 1));
    decreaseBtn.addEventListener('click', () => updateQuantity(quantity - 1));

    // Form submission
    document.getElementById('addToCartForm').addEventListener('submit', function(e) {
      const button = this.querySelector('.cart-btn span');
      const originalText = button.textContent;
      button.textContent = 'Adding...';
      this.querySelector('.cart-btn').disabled = true;
      
      // Reset after 2 seconds (adjust as needed)
      setTimeout(() => {
        button.textContent = originalText;
        this.querySelector('.cart-btn').disabled = false;
      }, 2000);
    });

    // Initialize
    updateQuantity(1);

    // Keyboard navigation for size buttons
    document.addEventListener('keydown', function(e) {
      if (e.target.classList.contains('size-btn')) {
        const buttons = Array.from(sizeButtons);
        const currentIndex = buttons.indexOf(e.target);
        
        switch(e.key) {
          case 'ArrowLeft':
          case 'ArrowUp':
            e.preventDefault();
            const prevIndex = currentIndex > 0 ? currentIndex - 1 : buttons.length - 1;
            buttons[prevIndex].focus();
            break;
          case 'ArrowRight':
          case 'ArrowDown':
            e.preventDefault();
            const nextIndex = currentIndex < buttons.length - 1 ? currentIndex + 1 : 0;
            buttons[nextIndex].focus();
            break;
        }
      }
    });
  </script>
</body>
</html>