<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ product.name }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-gold: #D4AF37;
      --dark-gold: #B8941F;
      --light-gold: #F5E6A3;
      --accent-gold: #FFD700;
      --text-dark: #1a1a1a;
      --text-medium: #4a4a4a;
      --text-light: #6b6b6b;
      --bg-primary: #fafafa;
      --bg-secondary: #ffffff;
      --border-light: #e8e8e8;
      --shadow-light: rgba(212, 175, 55, 0.1);
      --shadow-medium: rgba(212, 175, 55, 0.15);
      --shadow-heavy: rgba(0, 0, 0, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #fafafa 0%, #f0f0f0 100%);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--text-dark);
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 60px auto 40px;
      background: var(--bg-secondary);
      border-radius: 24px;
      box-shadow: 
        0 20px 60px var(--shadow-light),
        0 8px 25px var(--shadow-heavy);
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 60px;
      padding: 50px;
      position: relative;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-gold), var(--accent-gold), var(--primary-gold));
      border-radius: 24px 24px 0 0;
    }

    /* Gallery Section */
    .gallery-col {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .main-image-container {
      position: relative;
      overflow: hidden;
      border-radius: 20px;
      box-shadow: 0 15px 35px var(--shadow-medium);
      background: linear-gradient(45deg, #f8f8f8, #ffffff);
    }

    .main-image {
      width: 100%;
      height: 450px;
      object-fit: cover;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: zoom-in;
    }

    .main-image:hover {
      transform: scale(1.05);
    }

    .image-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        45deg,
        rgba(212, 175, 55, 0.05) 0%,
        transparent 50%,
        rgba(255, 215, 0, 0.05) 100%
      );
      pointer-events: none;
    }

    .thumb-list {
      display: flex;
      gap: 12px;
      padding: 5px;
      overflow-x: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--primary-gold) transparent;
    }

    .thumb-list::-webkit-scrollbar {
      height: 6px;
    }

    .thumb-list::-webkit-scrollbar-track {
      background: rgba(212, 175, 55, 0.1);
      border-radius: 10px;
    }

    .thumb-list::-webkit-scrollbar-thumb {
      background: var(--primary-gold);
      border-radius: 10px;
    }

    .thumb-list img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 12px;
      cursor: pointer;
      border: 3px solid transparent;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      flex-shrink: 0;
    }

    .thumb-list img:hover {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 8px 20px var(--shadow-medium);
    }

    .thumb-list img.selected {
      border-color: var(--primary-gold);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px var(--shadow-medium);
    }

    /* Product Info Section */
    .info-col {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 24px;
    }

    .product-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--primary-gold), var(--accent-gold));
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      width: fit-content;
      box-shadow: 0 4px 12px var(--shadow-light);
    }

    .product-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--text-dark);
      line-height: 1.2;
      margin: 0;
      background: linear-gradient(135deg, var(--text-dark) 0%, var(--text-medium) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .price-container {
      display: flex;
      align-items: baseline;
      gap: 12px;
      margin: 10px 0;
    }

    .price-range {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--primary-gold);
      text-shadow: 0 2px 4px var(--shadow-light);
    }

    .old-price {
      color: var(--text-light);
      text-decoration: line-through;
      font-size: 1.2rem;
      font-weight: 400;
    }

    .discount-badge {
      background: #ff4757;
      color: white;
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    /* Size Selection */
    .size-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .size-label {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-dark);
      letter-spacing: 0.5px;
    }

    .size-buttons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .size-btn {
      background: linear-gradient(135deg, white, #f8f8f8);
      border: 2px solid var(--border-light);
      border-radius: 12px;
      color: var(--text-medium);
      font-weight: 600;
      padding: 12px 24px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      min-width: 80px;
      text-align: center;
    }

    .size-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .size-btn:hover::before {
      left: 100%;
    }

    .size-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px var(--shadow-light);
      border-color: var(--primary-gold);
    }

    .size-btn.active {
      background: linear-gradient(135deg, var(--primary-gold), var(--accent-gold));
      color: white;
      border-color: var(--dark-gold);
      box-shadow: 0 8px 20px var(--shadow-medium);
      transform: translateY(-1px);
    }

    /* Purchase Section */
    .purchase-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
      padding: 24px;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.03), rgba(255, 215, 0, 0.03));
      border-radius: 16px;
      border: 1px solid rgba(212, 175, 55, 0.1);
    }

    .purchase-row {
      display: flex;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    .quantity-box {
      display: flex;
      align-items: center;
      background: white;
      border: 2px solid var(--border-light);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      overflow: hidden;
    }

    .quantity-btn {
      border: none;
      background: linear-gradient(135deg, #f8f8f8, white);
      font-size: 1.2rem;
      padding: 12px 16px;
      color: var(--primary-gold);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .quantity-btn:hover {
      background: var(--primary-gold);
      color: white;
    }

    .quantity-btn:active {
      transform: scale(0.95);
    }

    .quantity-display {
      min-width: 40px;
      text-align: center;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-dark);
      padding: 0 8px;
      background: white;
    }

    .btn-atc {
      background: linear-gradient(135deg, var(--primary-gold), var(--accent-gold));
      color: white;
      font-weight: 700;
      border: none;
      border-radius: 12px;
      padding: 16px 32px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      letter-spacing: 1px;
      text-transform: uppercase;
      box-shadow: 0 8px 20px var(--shadow-medium);
      position: relative;
      overflow: hidden;
      flex: 1;
      min-width: 180px;
    }

    .btn-atc::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .btn-atc:hover::before {
      left: 100%;
    }

    .btn-atc:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px var(--shadow-medium);
      background: linear-gradient(135deg, var(--dark-gold), var(--primary-gold));
    }

    .btn-atc:active {
      transform: translateY(0);
    }

    /* Features List */
    .features-section {
      background: rgba(248, 248, 248, 0.5);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid var(--border-light);
    }

    .features-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .features-title::before {
      content: 'âœ¨';
      font-size: 1.2rem;
    }

    .features-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .features-list li {
      color: var(--text-medium);
      font-size: 0.95rem;
      position: relative;
      padding-left: 24px;
    }

    .features-list li::before {
      content: 'â€¢';
      color: var(--primary-gold);
      font-weight: bold;
      position: absolute;
      left: 0;
      font-size: 1.2rem;
    }

    /* Description Section */
    .desc-section {
      grid-column: 1 / -1;
      margin-top: 40px;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.02), rgba(255, 215, 0, 0.02));
      border-radius: 20px;
      padding: 40px;
      border: 1px solid rgba(212, 175, 55, 0.1);
      position: relative;
    }

    .desc-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-gold), var(--accent-gold), var(--primary-gold));
      border-radius: 20px 20px 0 0;
    }

    .desc-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.75rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 20px;
      position: relative;
      padding-bottom: 12px;
    }

    .desc-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-gold), var(--accent-gold));
      border-radius: 2px;
    }

    .desc-content {
      color: var(--text-medium);
      font-size: 1.05rem;
      line-height: 1.8;
      text-align: justify;
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .container {
        max-width: 95%;
        margin: 40px auto;
        padding: 40px;
        gap: 40px;
      }

      .product-title {
        font-size: 2.2rem;
      }
    }

    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
        gap: 30px;
        padding: 30px 20px;
        margin: 20px auto;
      }

      .main-image {
        height: 350px;
      }

      .product-title {
        font-size: 1.8rem;
      }

      .price-range {
        font-size: 1.5rem;
      }

      .purchase-row {
        flex-direction: column;
        align-items: stretch;
      }

      .btn-atc {
        width: 100%;
      }

      .size-buttons {
        justify-content: center;
      }

      .desc-section {
        padding: 30px 20px;
      }

      .desc-title {
        font-size: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 20px 15px;
        border-radius: 16px;
        margin: 10px;
      }

      .main-image {
        height: 280px;
      }

      .product-title {
        font-size: 1.6rem;
      }

      .price-range {
        font-size: 1.3rem;
      }

      .thumb-list img {
        width: 65px;
        height: 65px;
      }

      .size-btn {
        padding: 10px 20px;
        font-size: 0.9rem;
      }

      .purchase-section {
        padding: 20px;
      }

      .features-section {
        padding: 20px;
      }

      .desc-section {
        padding: 25px 15px;
      }
    }

    /* Loading Animation */
    @keyframes shimmer {
      0% { opacity: 1; }
      50% { opacity: 0.7; }
      100% { opacity: 1; }
    }

    .loading {
      animation: shimmer 1.5s ease-in-out infinite;
    }

    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }

    /* Focus styles for accessibility */
    .size-btn:focus,
    .quantity-btn:focus,
    .btn-atc:focus {
      outline: 2px solid var(--primary-gold);
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="gallery-col">
      <div class="main-image-container">
        <img src="{{ product.imgs[0] }}" id="mainImage" alt="{{ product.name }}" class="main-image" />
        <div class="image-overlay"></div>
      </div>
      <div class="thumb-list" id="thumbs">
        {% for img in product.imgs %}
          <img src="{{ img }}" class="{% if loop.index0 == 0 %}selected{% endif %}" data-idx="{{ loop.index0 }}" alt="Product image {{ loop.index }}" />
        {% endfor %}
      </div>
    </div>

    <div class="info-col">
      <div class="product-badge">Premium Quality</div>
      
      <h1 class="product-title">{{ product.name }}</h1>
      
      <div class="price-container">
        <div class="price-range" id="priceDisplay">
          â‚¹{{ product.price_small }} â€“ â‚¹{{ product.price_large }}
        </div>
        <!-- Uncomment if you have old prices
        <span class="old-price">â‚¹{{ product.old_price }}</span>
        <span class="discount-badge">Save 20%</span>
        -->
      </div>

      <div class="size-section">
        <label class="size-label" for="sizeButtons">Select Size</label>
        <div class="size-buttons" id="sizeButtons" role="radiogroup" aria-label="Product size selection">
          <button type="button" class="size-btn" data-size="small" data-price="{{ product.price_small|replace('â‚¹','')|replace(',','') }}" role="radio" aria-checked="false">Small</button>
          <button type="button" class="size-btn active" data-size="medium" data-price="{{ product.price_medium|replace('â‚¹','')|replace(',','') }}" role="radio" aria-checked="true">Medium</button>
          <button type="button" class="size-btn" data-size="large" data-price="{{ product.price_large|replace('â‚¹','')|replace(',','') }}" role="radio" aria-checked="false">Large</button>
        </div>
      </div>

      <div class="purchase-section">
        <form id="addToCartForm" method="POST" action="{{ url_for('add_to_cart') }}">
          <div class="purchase-row">
            <div class="quantity-box">
              <button type="button" class="quantity-btn" id="decreaseQty" aria-label="Decrease quantity">âˆ’</button>
              <span class="quantity-display" id="qtyDisplay" role="status" aria-label="Current quantity">1</span>
              <button type="button" class="quantity-btn" id="increaseQty" aria-label="Increase quantity">+</button>
            </div>
            <input type="hidden" name="quantity" id="qtyInput" value="1" />
            <input type="hidden" name="product_id" value="{{ product.id }}" />
            <input type="hidden" name="size" id="selectedSize" value="medium" />
            <button type="submit" class="btn-atc" aria-label="Add item to shopping cart">
              Add to Cart
            </button>
          </div>
        </form>
      </div>

      <div class="features-section">
        <div class="features-title">Key Features</div>
        <ul class="features-list">
          {% if product.features %}
            {% for feature in product.features %}
              <li>{{ feature }}</li>
            {% endfor %}
          {% else %}
            <li>Premium quality materials</li>
            <li>Expert craftsmanship</li>
            <li>Satisfaction guaranteed</li>
            <li>Fast & secure delivery</li>
          {% endif %}
        </ul>
      </div>
    </div>

    <div class="desc-section">
      <h2 class="desc-title">Product Description</h2>
      <div class="desc-content">
        {{ product.desc_long if product.desc_long else product.desc if product.desc else "This premium product combines exceptional quality with elegant design. Crafted with attention to detail and built to last, it offers the perfect blend of functionality and style. Each piece is carefully inspected to ensure it meets our high standards of excellence." }}
      </div>
    </div>
  </div>

  <script>
    // Enhanced image gallery functionality
    document.querySelectorAll('#thumbs img').forEach((img, index) => {
      img.addEventListener('click', function () {
        const mainImage = document.getElementById('mainImage');
        
        // Add loading effect
        mainImage.classList.add('loading');
        
        setTimeout(() => {
          mainImage.src = this.src;
          mainImage.classList.remove('loading');
        }, 150);
        
        // Update selected thumbnail
        document.querySelectorAll('#thumbs img').forEach(i => i.classList.remove('selected'));
        this.classList.add('selected');
      });

      // Add keyboard navigation
      img.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          this.click();
        }
      });

      img.setAttribute('tabindex', '0');
    });

    // Enhanced size selection with animation
    const sizeButtons = document.querySelectorAll('.size-btn');
    const priceDisplay = document.getElementById('priceDisplay');
    const selectedSizeInput = document.getElementById('selectedSize');

    sizeButtons.forEach(btn => {
      btn.addEventListener('click', function () {
        // Update active state
        sizeButtons.forEach(b => {
          b.classList.remove('active');
          b.setAttribute('aria-checked', 'false');
        });
        this.classList.add('active');
        this.setAttribute('aria-checked', 'true');
        selectedSizeInput.value = this.dataset.size;

        // Animate price change
        const priceValue = parseFloat(this.dataset.price);
        if (!isNaN(priceValue)) {
          priceDisplay.style.transform = 'scale(0.95)';
          priceDisplay.style.opacity = '0.7';
          
          setTimeout(() => {
            priceDisplay.textContent = "â‚¹" + priceValue.toLocaleString('en-IN');
            priceDisplay.style.transform = 'scale(1)';
            priceDisplay.style.opacity = '1';
          }, 150);
        }
      });
    });

    // Enhanced quantity controls with validation
    let qty = 1;
    const qtyDisplay = document.getElementById('qtyDisplay');
    const qtyInput = document.getElementById('qtyInput');
    const increaseBtn = document.getElementById('increaseQty');
    const decreaseBtn = document.getElementById('decreaseQty');

    function updateQuantity(newQty) {
      qty = Math.max(1, Math.min(10, newQty));
      qtyDisplay.textContent = qty;
      qtyInput.value = qty;
      
      // Update button states
      decreaseBtn.style.opacity = qty <= 1 ? '0.5' : '1';
      increaseBtn.style.opacity = qty >= 10 ? '0.5' : '1';
      
      // Add animation
      qtyDisplay.style.transform = 'scale(1.1)';
      setTimeout(() => {
        qtyDisplay.style.transform = 'scale(1)';
      }, 150);
    }

    increaseBtn.addEventListener('click', () => updateQuantity(qty + 1));
    decreaseBtn.addEventListener('click', () => updateQuantity(qty - 1));

    // Form submission enhancement
    document.getElementById('addToCartForm').addEventListener('submit', function(e) {
      const button = this.querySelector('.btn-atc');
      button.innerHTML = '<span style="opacity: 0.7;">Adding...</span>';
      button.disabled = true;
      
      // Re-enable after 2 seconds (adjust as needed for your backend)
      setTimeout(() => {
        button.innerHTML = 'Add to Cart';
        button.disabled = false;
      }, 2000);
    });

    // Initialize button states
    updateQuantity(1);

    // Add smooth transitions for all interactive elements
    document.querySelectorAll('.size-btn, .quantity-btn, .btn-atc, #thumbs img').forEach(element => {
      element.style.transition = 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
    });

    // Lazy loading for images (if needed)
    if ('IntersectionObserver' in window) {
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            if (img.dataset.src) {
              img.src = img.dataset.src;
              img.removeAttribute('data-src');
              observer.unobserve(img);
            }
          }
        });
      });

      document.querySelectorAll('img[data-src]').forEach(img => {
        imageObserver.observe(img);
      });
    }

    // Add keyboard navigation for better accessibility
    document.addEventListener('keydown', function(e) {
      if (e.target.classList.contains('size-btn')) {
        const buttons = Array.from(sizeButtons);
        const currentIndex = buttons.indexOf(e.target);
        
        switch(e.key) {
          case 'ArrowLeft':
          case 'ArrowUp':
            e.preventDefault();
            const prevIndex = currentIndex > 0 ? currentIndex - 1 : buttons.length - 1;
            buttons[prevIndex].focus();
            break;
          case 'ArrowRight':
          case 'ArrowDown':
            e.preventDefault();
            const nextIndex = currentIndex < buttons.length - 1 ? currentIndex + 1 : 0;
            buttons[nextIndex].focus();
            break;
        }
      }
    });
  </script>
</body>
</html>